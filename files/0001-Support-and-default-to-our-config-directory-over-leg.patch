From 3b8e3245a2269a1c5fb6148eda6556aab7fe3add Mon Sep 17 00:00:00 2001
From: Joshua Strobl <joshua@streambits.io>
Date: Mon, 27 Jul 2020 21:30:47 +0300
Subject: [PATCH 1/1] Support and default to our config directory over legacy
 .solus

---
 src/builder/build.go    | 2 +-
 src/builder/userinfo.go | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/builder/build.go b/src/builder/build.go
index eed588c..d3a86f0 100644
--- a/src/builder/build.go
+++ b/src/builder/build.go
@@ -268,7 +268,7 @@ func (p *Package) CopyAssets(h *PackageHistory, o *Overlay) error {
 // PrepYpkg will do the initial leg work of preparing us for a ypkg build.
 func (p *Package) PrepYpkg(notif PidNotifier, usr *UserInfo, pman *EopkgManager, overlay *Overlay, h *PackageHistory) error {
 	log.Debug("Writing packager file")
-	fp := filepath.Join(overlay.MountPoint, BuildUserHome, ".solus", "packager")
+	fp := filepath.Join(overlay.MountPoint, BuildUserHome, ".config", "solus", "packager")
 	fpd := filepath.Dir(fp)
 
 	if !PathExists(fpd) {
diff --git a/src/builder/userinfo.go b/src/builder/userinfo.go
index 16fb946..90cb2a6 100644
--- a/src/builder/userinfo.go
+++ b/src/builder/userinfo.go
@@ -26,7 +26,7 @@ import (
 	"strconv"
 )
 
-// UserInfo is required for ypkg builds, to set the .solus/package internally
+// UserInfo is required for ypkg builds, to set the .config/solus/package internally
 // and propagate the author details.
 type UserInfo struct {
 	Name     string // Actual name
@@ -119,10 +119,10 @@ func (u *UserInfo) SetFromCurrent() {
 	}
 }
 
-// SetFromPackager will set the username/email fields from the legacy solus
-// packager file.
+// SetFromPackager will set the username/email fields from one of our packager files
 func (u *UserInfo) SetFromPackager() bool {
 	candidatePaths := []string{
+		filepath.Join(u.HomeDir, ".config", "solus", "packager"),
 		filepath.Join(u.HomeDir, ".solus", "packager"),
 		filepath.Join(u.HomeDir, ".evolveos", "packager"),
 	}
-- 
2.27.0

